<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Buckets · IOV Documentations</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&gt; code reference (bucket): https://github.com/iov-one/blog-tutorial/blob/master/x/blog/bucket.go"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Buckets · IOV Documentations"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.iov.one/"/><meta property="og:description" content="&gt; code reference (bucket): https://github.com/iov-one/blog-tutorial/blob/master/x/blog/bucket.go"/><meta property="og:image" content="https://docs.iov.one/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://docs.iov.one/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.png" alt="IOV Documentations"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://github.com/iov-one" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Tutorial</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Introduction<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/intro">Welcome to IOV!</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">IOV Name Service<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Validator</h4><ul><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/validator/rewards">Rewards</a></li><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/validator/testnet-dancenet">Testnet (deprecated)</a></li><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/validator/testnet">Testnet v1.0.0</a></li><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/validator/mainnet">Mainnet</a></li><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/validator/troubleshooter">Troubleshooter</a></li><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/validator/faq">FAQ</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Clients</h4><ul><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/clients/iov-core">IOV Core</a></li><li class="navListItem"><a class="navItem" href="/docs/iov-name-service/clients/rest-api">REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">IOV Weave SDK<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/weave/welcome">Welcome</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Basics</h4><ul><li class="navListItem"><a class="navItem" href="/docs/weave/basics/blockchain">Blockchain</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/basics/consensus">Consensus</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/basics/authentication">Authentication</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/basics/state">State Machine</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Design</h4><ul><li class="navListItem"><a class="navItem" href="/docs/weave/design/overview">Guiding Design Principles</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/design/extension">Extension</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/design/transaction-flow">Flow of Transactions</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/design/permissions">Permissions</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/design/queries">Queries</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/design/prototool">Prototool</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Configuration</h4><ul><li class="navListItem"><a class="navItem" href="/docs/weave/configuration/application">Application</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API specifications</h4><ul><li class="navListItem"><a class="navItem" href="/docs/weave/weave-api-spec/address-derivation">Address Derivation</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/weave-api-spec/weave-transaction-spec">Weave Transactions</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/weave-api-spec/tx-sign-spec">Transaction Signatures</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/weave-api-spec/weave-query-spec">Querying Weave</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/weave-api-spec/modules">Modules</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Tutorial</h4><ul><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/installation">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/domain">Domain</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/codec">Codec</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/models">Models</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/messages">Messages</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/weave/tutorial/buckets">Buckets</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/handlers">Handlers</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/app-level-codec">Application Level Codec</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/application">Application</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/batch-txs">Batch Transactions</a></li><li class="navListItem"><a class="navItem" href="/docs/weave/tutorial/cron-tasks">Scheduled Tasks</a></li></ul></div></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Buckets</h1></header><article><div><span><blockquote>
<p>code reference (bucket): <a href="https://github.com/iov-one/blog-tutorial/blob/master/x/blog/bucket.go">https://github.com/iov-one/blog-tutorial/blob/master/x/blog/bucket.go</a></p>
</blockquote>
<blockquote>
<p>code reference (test): <a href="https://github.com/iov-one/blog-tutorial/blob/master/x/blog/bucket_test.go">https://github.com/iov-one/blog-tutorial/blob/master/x/blog/bucket_test.go</a></p>
</blockquote>
<p>In Weave framework, Buckets are the standard way to access and manipulate data, which is stored in <em>Key-Value Database</em>. Weave buckets could be found similar to <a href="https://github.com/boltdb/bolt#using-buckets" title="Bolt Repo">BoltDB</a> or <a href="https://github.com/google/leveldb" title="LevelDB Repo">LevelDB</a> design. Any extension can use one or multiple Buckets to store and access data. Buckets offer the following advantages:</p>
<ul>
<li>Isolation between extensions (each Bucket has a unique prefix that is transparently prepended to the keys)</li>
<li>Type safety (enforce all data stored in a Bucket to be the same type, to avoid parse errors later on)</li>
<li>Indexes (Buckets are well integrated with the secondary indexes and keep them in sync every time data is modified)</li>
<li>Querying (Buckets can easily register query handlers including prefix queries and secondary index queries)</li>
</ul>
<p>All extensions from Weave use Buckets, so for compatibility as well as the features, <strong>please use Buckets in your app</strong>, unless you have a very good reason not to (and know what you are doing).</p>
<p>To use buckets, models must be wrapped in <code>SimpleObj</code>.</p>
<pre><code class="hljs css language-go"><span class="hljs-keyword">type</span> SimpleObj <span class="hljs-keyword">struct</span> {
    key   []<span class="hljs-keyword">byte</span>
    value CloneableData
}
</code></pre>
<p>Easiest way to achieve this is to use <code>ModelBucket</code>.</p>
<pre><code class="hljs css language-go">b := orm.NewModelBucket(<span class="hljs-string">"user"</span>, &amp;User{})
</code></pre>
<p><code>orm.NewModelBucket</code> wraps <code>User</code> in SimpleObj internally:</p>
<pre><code class="hljs css language-go"><span class="hljs-comment">// NewModelBucket returns a ModelBucket instance. This implementation relies on</span>
<span class="hljs-comment">// a bucket instance. Final implementation should operate directly on the</span>
<span class="hljs-comment">// KVStore instead.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewModelBucket</span><span class="hljs-params">(name <span class="hljs-keyword">string</span>, m Model, opts ...ModelBucketOption)</span> <span class="hljs-title">ModelBucket</span></span> {
    b := NewBucket(name, NewSimpleObj(<span class="hljs-literal">nil</span>, m))
</code></pre>
<!---
TODO refactor here when blog is upgraded to v0.22.0
-->
<p>And be sure protobuf objects implemented <code>CloneableData</code>:</p>
<pre><code class="hljs css language-go">    Clone() Object
}

<span class="hljs-comment">// CloneableData is an intelligent Value that can be embedded</span>
<span class="hljs-comment">// in a simple object to handle much of the details.</span>
</code></pre>
<p>Bucket name must comply with <code>^[a-z_]{3,10}$</code> regex rule, meaning names must be between 3 to 10 characters and all lower case.</p>
<p>This basically consists of adding <em>Copy()</em> and <em>Validate()</em> to the objects in <code>codec.pb.go</code>. On <a href="/docs/weave/tutorial/models">Models</a> section, we implemented <em>Copy()</em> and <em>Validate()</em> as you remember. Now it makes sense, right?</p>
<h2><a class="anchor" aria-hidden="true" id="dive-into-code"></a><a href="#dive-into-code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dive into Code</h2>
<p>Let's define <code>UserBucket</code> that will hold <code>User</code> information and write a function that creates an user. This is a basic <code>morm/model_bucket</code> without any secondary index.</p>
<pre><code class="hljs css language-go"><span class="hljs-keyword">type</span> UserBucket <span class="hljs-keyword">struct</span> {
    morm.ModelBucket
}

<span class="hljs-comment">// NewUserBucket returns a new user bucket</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewUserBucket</span><span class="hljs-params">()</span> *<span class="hljs-title">UserBucket</span></span> {
    <span class="hljs-keyword">return</span> &amp;UserBucket{
        morm.NewModelBucket(<span class="hljs-string">"user"</span>, &amp;User{}),
    }
}
</code></pre>
<p>We will demonstrate secondary index usage with <code>ArticleBucket</code>. Secondary indexes enable you to insert and query models with ease. Think of this as a SQL index.</p>
<pre><code class="hljs css language-go"><span class="hljs-keyword">type</span> ArticleBucket <span class="hljs-keyword">struct</span> {
    morm.ModelBucket
}

<span class="hljs-comment">// NewArticleBucket returns a new article bucket</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewArticleBucket</span><span class="hljs-params">()</span> *<span class="hljs-title">ArticleBucket</span></span> {
    <span class="hljs-keyword">return</span> &amp;ArticleBucket{
        morm.NewModelBucket(<span class="hljs-string">"article"</span>, &amp;Article{},
            morm.WithIndex(<span class="hljs-string">"blog"</span>, articleBlogIDIndexer, <span class="hljs-literal">false</span>),
            morm.WithIndex(<span class="hljs-string">"timedBlog"</span>, blogTimedIndexer, <span class="hljs-literal">false</span>)),
    }
}
</code></pre>
<p>Let's explain what the heck is <code>morm.WithIndex(&quot;blog&quot;, articleBlogIDIndexer, false)</code>?</p>
<h2><a class="anchor" aria-hidden="true" id="secondary-indexes"></a><a href="#secondary-indexes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Secondary Indexes</h2>
<p>Sometimes we need another index for the data. Generally, we will look up an article from the blog it belongs to and its index in the article. But what if we want to list all articles of a blog in all article instances? For this, we need to add a secondary index on the articles to query by blog. This is a typical case and Weave provides nice support for this functionality.</p>
<p>We add an indexing method to take any object, enforce the type to be a proper Article, then extract the index we want. This can be a field or any deterministic transformation of one (or multiple) fields. The output of the index becomes key in another query. Bucket provides a simple method to query by index.</p>
<p><strong>articleBlogIDIndexer</strong> is a secondary index with only <strong>BlogID</strong>. This is a simple index form to implement. It binds Article to a BlogID(<em>bytes</em>).</p>
<p>Weave uses uniformed <em>bytes</em> as indexes. This improves performance.</p>
<pre><code class="hljs css language-go"><span class="hljs-comment">// articleBlogIDIndexer enables querying articles by blog ids</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">articleBlogIDIndexer</span><span class="hljs-params">(obj orm.Object)</span> <span class="hljs-params">([]<span class="hljs-keyword">byte</span>, error)</span></span> {
    <span class="hljs-keyword">if</span> obj == <span class="hljs-literal">nil</span> || obj.Value() == <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">nil</span>
    }
    article, ok := obj.Value().(*Article)
    <span class="hljs-keyword">if</span> !ok {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errors.Wrapf(errors.ErrState, <span class="hljs-string">"expected article, got %T"</span>, obj.Value())
    }
    <span class="hljs-keyword">return</span> article.BlogID, <span class="hljs-literal">nil</span>
}
</code></pre>
<p>You must have ideas flying around in your mind like <strong>how are we going to make a compound index? Really!? Is it all Weave has?</strong></p>
<p>Don't worry. Weave is like a Swiss Army knife with a lot of blockchain features.</p>
<p>Here is how we create compound index for morm buckets:</p>
<pre><code class="hljs css language-go"><span class="hljs-comment">// BuildBlogTimedIndex produces 8 bytes BlogID || big-endian createdAt</span>
<span class="hljs-comment">// This allows lexographical searches over the time ranges (or earliest or latest)</span>
<span class="hljs-comment">// of all articles within one blog</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">BuildBlogTimedIndex</span><span class="hljs-params">(article *Article)</span> <span class="hljs-params">([]<span class="hljs-keyword">byte</span>, error)</span></span> {
    res := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">byte</span>, <span class="hljs-number">16</span>)
    <span class="hljs-built_in">copy</span>(res, article.BlogID)
    <span class="hljs-comment">// this would violate lexographical ordering as negatives would be highest</span>
    <span class="hljs-keyword">if</span> article.CreatedAt &lt; <span class="hljs-number">0</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errors.Wrap(errors.ErrState, <span class="hljs-string">"cannot index negative creation times"</span>)
    }
    binary.BigEndian.PutUint64(res[<span class="hljs-number">8</span>:], <span class="hljs-keyword">uint64</span>(article.CreatedAt))
    <span class="hljs-keyword">return</span> res, <span class="hljs-literal">nil</span>
}
</code></pre>
<p>We can query all articles that are posted in a blog over the time ranges(earliest or latest)</p>
<h2><a class="anchor" aria-hidden="true" id="querying-buckets"></a><a href="#querying-buckets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Querying buckets</h2>
<p>On <a href="weave/weave-api-spec/weave-query-spec">Weave API spec</a> documentation querying <code>bns</code> buckets has been explained. If we were to give an example of querying on comment bucket it would have been via RPC endpoints:</p>
<pre><code class="hljs css language-sh">curl -X POST -d <span class="hljs-string">'{ "json-rpc": 2.0, "id": "foobar321",
"method": "abci_query", "params": { "path": "/comment/articleuser", "data": "0000000100000001" } }'</span> \
https://rpc.blog.testnet.iov.one/
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="custom-buckets"></a><a href="#custom-buckets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom Buckets</h2>
<p>Data consistency must be enforced on buckets. All data is validated before saving, but we also need to make sure that all the data corresponds to the correct object type before saving. Unfortunately, this is quite difficult to compile-time without generic, so a typical approach is to embed the orm.Bucket in another struct and just force validation of the object type runtime before save. Wrap an orm.ModelBucket with the functionalities you desire - there you have a custom bucket to serve your needs.
Truth time: <code>morm.ModelBucket</code> is a refinement of <code>weave/orm.ModelBucket</code>. We used morm modules instead of orm to show you even buckets are customizable to your needs. You can compare <a href="https://github.com/iov-one/tutorial/blob/master/morm/model_bucket.go#L40">morm</a> and <a href="https://github.com/iov-one/weave/tree/master/orm">weave/orm</a> and see how to implement your custom bucket.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated by Orkun Külçe</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/weave/tutorial/messages"><span class="arrow-prev">← </span><span>Messages</span></a><a class="docs-next button" href="/docs/weave/tutorial/handlers"><span>Handlers</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#dive-into-code">Dive into Code</a></li><li><a href="#secondary-indexes">Secondary Indexes</a></li><li><a href="#querying-buckets">Querying buckets</a></li><li><a href="#custom-buckets">Custom Buckets</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"></a><div><h5>Docs</h5><a href="/docs/iov-name-service/validator/rewards">IOV Name Service</a><a href="/docs/weave/welcome">Weave</a></div><div><h5>Community</h5><a href="https://riot.im/app/#/room/#weave:matrix.org" target="_blank">Riot Chat</a><a href="https://t.me/internetofvalues" target="_blank">Telegram</a><a href="https://twitter.com/iov_official" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="https://github.com/iov-one" target="_blank">GitHub</a><a href="https://www.iov.one" target="_blank">Website</a></div></section><section class="copyright">Copyright © 2020 IOV</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '8dc8128a9091306e7bbd0effdaa5241a',
                indexName: 'iov',
                inputSelector: '#search_input_react'
              });
            </script></body></html>